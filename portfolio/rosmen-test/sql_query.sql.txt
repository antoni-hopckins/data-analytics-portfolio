/*
Запрос для тестового задания РОСМЭН.
Задача: получить товарный запас в шт по партнеру Ozon в разрезе складов на 31.03.2024
*/

SELECT 
    Warehouse AS 'Склад',           -- Название склада
    SUM(Amount) AS 'ТЗ, шт'         -- Суммарный остаток в штуках
FROM Stocks
WHERE Partner = 'OZON'              -- Фильтр по партнеру Ozon
    AND Date = '2024-03-31'         -- Фильтр по дате (конец периода)
GROUP BY Warehouse                  -- Группировка по складам
ORDER BY SUM(Amount) DESC;          -- Сортировка по убыванию остатка